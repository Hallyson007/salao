<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>ğŸ¢ Sistema de TerritÃ³rios - Monte Castelo / Centro</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <a class="skip-link" href="#mainContent">Ir para conteÃºdo</a>

  <div class="app" id="app">
    <header role="banner">
      <div class="header-content">
        <div class="header-left">
          <button id="sidebarToggle" class="sidebar-toggle" aria-label="Menu" type="button">â˜°</button>
          <div>
            <div class="brand">ğŸ¢ Sistema de TerritÃ³rios</div>
            <div class="subtitle">Monte Castelo / Centro</div>
          </div>
        </div>
        
        <nav class="header-actions">
          <button id="undoBtn" class="btn btn-primary" title="Desfazer (Ctrl+Z)">â†¶ <span class="btn-label">Desfazer</span></button>
          <button id="redoBtn" class="btn btn-primary" title="Refazer (Ctrl+Y)">â†· <span class="btn-label">Refazer</span></button>
          <button id="saveBtn" class="btn btn-primary" title="Salvar">ğŸ’¾ <span class="btn-label">Salvar</span></button>
          <button id="exportBtn" class="btn btn-primary" title="Exportar">ğŸ“¤ <span class="btn-label">Exportar</span></button>
          <button id="importBtn" class="btn btn-primary" title="Importar">ğŸ“¥ <span class="btn-label">Importar</span></button>
          <input id="fileInput" type="file" accept="application/json" hidden>
          <button id="copySummaryBtn" class="btn btn-primary" title="Copiar">ğŸ“‹ <span class="btn-label">Copiar</span></button>
          <button id="shareBtn" class="btn btn-primary" title="WhatsApp">ğŸ“² <span class="btn-label">WhatsApp</span></button>
          <button id="themeBtn" class="btn btn-primary" title="Tema">ğŸŒ™ <span class="btn-label">Tema</span></button>
          <button id="newTerritoryBtn" class="btn btn-success" title="Novo">â• <span class="btn-label">Novo</span></button>
        </nav>
      </div>
    </header>

    <div class="layout" id="layoutRoot">
      <aside class="sidebar" id="sidebar">
        <h3>ğŸ“‹ VisÃ£o Geral</h3>
        <div class="search">
          <input id="territorySearch" type="search" placeholder="ğŸ” Buscar...">
        </div>
        <div style="margin-bottom:12px;padding:6px 0;border-bottom:2px solid var(--border)">
          <small style="color:var(--text-secondary)">Total:</small>
          <strong id="totalTerritories">0</strong>
        </div>
        <div class="territory-list" id="territoriesList"></div>
      </aside>

      <main id="mainContent" class="content"></main>
    </div>
  </div>

  <div class="sidebar-overlay" id="sidebarOverlay"></div>
  <div id="tooltipContainer" class="tooltip"></div>
  <div id="toast" class="toast"></div>

  <!-- Modal Novo TerritÃ³rio -->
  <div id="newTerritoryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>â• Novo TerritÃ³rio</h2>
        <button class="close-modal" data-close="newTerritoryModal">Ã—</button>
      </div>
      <div class="form-group">
        <label>NÃºmero</label>
        <input id="newTerritoryNumber" type="number" placeholder="Ex: 25">
      </div>
      <div class="form-group">
        <label>Nome</label>
        <input id="newTerritoryName" type="text" placeholder="Ex: Rua Principal">
      </div>
      <div class="form-group">
        <label>CEP</label>
        <input id="newTerritoryCEP" type="text" placeholder="60325-000" maxlength="9">
      </div>
      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
        <button class="btn btn-secondary" data-close="newTerritoryModal">Cancelar</button>
        <button id="createTerritoryBtn" class="btn btn-success">Criar</button>
      </div>
    </div>
  </div>

  <!-- Modal Dias -->
  <div id="diasModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ“… Dia Trabalhado</h2>
        <button class="close-modal" data-close="diasModal">Ã—</button>
      </div>
      <div class="form-group">
        <label>Data</label>
        <input type="date" id="diaDate" required>
      </div>
      <div class="form-group">
        <label>Ruas/Quadras</label>
        <textarea id="diaRuas" placeholder="Ex: Rua A, Quadra 10"></textarea>
      </div>
      <div class="form-group">
        <label>ObservaÃ§Ãµes</label>
        <textarea id="diaObs" placeholder="Ex: ManhÃ£ chuvosa"></textarea>
      </div>
      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
        <button class="btn btn-secondary" data-close="diasModal">Cancelar</button>
        <button class="btn btn-success" id="saveDiaBtn">ğŸ’¾ Salvar</button>
      </div>
    </div>
  </div>

  <!-- Modal Blocos -->
  <div id="blockModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ¢ Selecionar Bloco</h2>
        <button class="close-modal" data-close="blockModal">Ã—</button>
      </div>
      <div class="block-selector" id="blockSelector"></div>
    </div>
  </div>

  <!-- Modal Apartamentos -->
  <div id="apartmentListModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="apartmentListTitle">ğŸ¢ Apartamentos</h2>
        <button class="close-modal" data-close="apartmentListModal">Ã—</button>
      </div>
      <div style="margin-bottom:16px">
        <label><input id="onlyNotedToggle" type="checkbox"> Mostrar sÃ³ com Notas</label>
      </div>
      <div class="apartment-selector" id="apartmentSelector"></div>
    </div>
  </div>

  <!-- Modal Apartamento -->
  <div id="apartmentModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="apartmentModalTitle">ğŸ  Apartamento</h2>
        <button class="close-modal" data-close="apartmentModal">Ã—</button>
      </div>
      <div class="form-group">
        <label>ğŸ“… Data</label>
        <input type="date" id="apartmentDia">
      </div>
      <div class="form-group">
        <label>ğŸ“‹ ObservaÃ§Ãµes</label>
        <textarea id="apartmentNotes" placeholder="Ex: Deixou carta"></textarea>
      </div>
      <div class="form-group">
        <label>ğŸ“Œ Status</label>
        <select id="apartmentStatus">
          <option value="">Selecione...</option>
          <option value="nao-visitado">ğŸ“˜ NÃ£o Visitado</option>
          <option value="ausente">ğŸšª Ausente</option>
          <option value="conversado">ğŸ’¬ Conversado</option>
          <option value="carta">âœ‰ï¸ Deixou Carta</option>
          <option value="folheto">ğŸ“„ Deixou Folheto</option>
          <option value="recusou">ğŸš« Recusou</option>
          <option value="estudo">ğŸ“š Estudo</option>
        </select>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px">
        <button class="btn btn-secondary" data-close="apartmentModal">Cancelar</button>
        <button id="deleteApartmentNoteBtn" class="btn btn-danger" style="display:none">ğŸ—‘ï¸</button>
        <button class="btn btn-success" id="saveApartmentNoteBtn">ğŸ’¾ Salvar</button>
      </div>
    </div>
  </div>

  <!-- Modal EndereÃ§o -->
  <div id="addressDetailsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ  Detalhes</h2>
        <button class="close-modal" data-close="addressDetailsModal">Ã—</button>
      </div>
      <div id="addressInfoDisplay" style="margin-bottom:16px"></div>
      <div class="form-group">
        <label>ğŸ“Œ Status</label>
        <select id="addressStatusSelect">
          <option value="">Selecione...</option>
          <option value="nao-visitado">ğŸ“˜ NÃ£o Visitado</option>
          <option value="ausente">ğŸšª Ausente</option>
          <option value="conversado">ğŸ’¬ Conversado</option>
          <option value="carta">âœ‰ï¸ Carta</option>
          <option value="folheto">ğŸ“„ Folheto</option>
          <option value="recusou">ğŸš« Recusou</option>
          <option value="estudo">ğŸ“š Estudo</option>
        </select>
      </div>
      <div class="form-group">
        <label>ğŸ“… Data</label>
        <input id="addressDia" type="date">
      </div>
      <div class="form-group">
        <label>ObservaÃ§Ãµes</label>
        <textarea id="addressObs" placeholder="Detalhes..."></textarea>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px">
        <button class="btn btn-secondary" data-close="addressDetailsModal">Cancelar</button>
        <button id="deleteAddressNoteBtn" class="btn btn-danger" style="display:none">ğŸ—‘ï¸</button>
        <button class="btn btn-success" id="saveAddressDetailsBtn">ğŸ’¾ Salvar</button>
      </div>
    </div>
  </div>

  <!-- Modal Adicionar Casa -->
  <div id="addHouseModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ  Adicionar Casa</h2>
        <button class="close-modal" data-close="addHouseModal">Ã—</button>
      </div>
      <div class="form-group">
        <label>CEP</label>
        <input id="houseCEP" type="text" placeholder="60325-000" maxlength="9">
        <button class="btn btn-primary" onclick="searchHouseCEP()" style="margin-top:8px">ğŸ” Buscar</button>
      </div>
      <div class="form-group">
        <label>Logradouro</label>
        <input id="houseLogradouro" type="text" placeholder="Rua, Avenida...">
      </div>
      <div class="form-group">
        <label>NÃºmero</label>
        <input id="houseNumero" type="text" placeholder="123">
      </div>
      <div class="form-group">
        <label>Bairro</label>
        <input id="houseBairro" type="text" placeholder="Monte Castelo">
      </div>
      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
        <button class="btn btn-secondary" data-close="addHouseModal">Cancelar</button>
        <button id="saveHouseBtn" class="btn btn-success">ğŸ’¾ Salvar</button>
      </div>
    </div>
  </div>

  <!-- Modal Adicionar PrÃ©dio -->
  <div id="addBuildingModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ¢ Adicionar PrÃ©dio</h2>
        <button class="close-modal" data-close="addBuildingModal">Ã—</button>
      </div>
      <div class="form-group">
        <label>CEP</label>
        <input id="buildingCEP" type="text" placeholder="60325-000" maxlength="9">
        <button class="btn btn-primary" onclick="searchBuildingCEP()" style="margin-top:8px">ğŸ” Buscar</button>
      </div>
      <div class="form-group">
        <label>Logradouro</label>
        <input id="buildingLogradouro" type="text" placeholder="Rua, Avenida...">
      </div>
      <div class="form-group">
        <label>NÃºmero</label>
        <input id="buildingNumero" type="text" placeholder="123">
      </div>
      <div class="form-group">
        <label>Nome do PrÃ©dio</label>
        <input id="buildingName" type="text" placeholder="EdifÃ­cio...">
      </div>
      <div class="form-group">
        <label>Bairro</label>
        <input id="buildingBairro" type="text" placeholder="Monte Castelo">
      </div>
      <div class="form-group">
        <label>Tipo de Portaria</label>
        <select id="buildingPortaria">
          <option value="porteiro">ğŸ‘¨ğŸ’¼ Porteiro</option>
          <option value="eletronica">ğŸ” EletrÃ´nica</option>
          <option value="interfone">ğŸ“ Interfone</option>
        </select>
      </div>
      <div class="form-group">
        <label>Blocos (ex: A,B,C ou 1,2,3)</label>
        <input id="buildingBlocks" type="text" placeholder="A,B,C">
      </div>
      <div id="blockApartmentsContainer"></div>
      <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px">
        <button class="btn btn-secondary" data-close="addBuildingModal">Cancelar</button>
        <button id="saveBuildingBtn" class="btn btn-success">ğŸ’¾ Salvar</button>
      </div>
    </div>
  </div>

  <script src="app_full.js"></script>
</body>
</html>
